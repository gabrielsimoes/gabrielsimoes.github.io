<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="theme-color" content="#aa4b41"><title>Object-relational impedance mismatch // Gabriel Simões</title><meta name="Description" content="Blog Article Object-relational impedance mismatch"><link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"><link rel="icon" href="/favicon.ico" type="image/x-icon"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Mono|Fira+Sans" media="all"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/normalize.css@8.0.0/normalize.min.css" media="all"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0-beta/dist/katex.min.css" media="all"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlightjs@9.10.0/styles/gruvbox-dark.min.css" media="all"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/simple-line-icons@2.4.1/css/simple-line-icons.min.css" media="all"><link rel="stylesheet" href="/style.css" media="all"></head><body><header><div class="header-top"><img class="my-image" src="/me-bw.png" alt="A picture of me"><p class="my-name">Gabriel Simões</p><p class="my-occupation">Software Developer</p></div><nav><ul class="nav-menu"><li class="nav-item"><a class="nav-item-content" href="/">Home</a></li><li class="nav-item"><a class="nav-item-content" href="/blog.html">Blog</a></li><li class="nav-item"><a class="nav-item-content" href="/reading-watching-list.html">Reading/Watching List</a></li></ul><div class="cv-wrapper"><a class="cv-btn" href="cv.pdf"><span class="icon-doc"> My CV</span></a></div><div class="social-list-wrapper"><ul class="social-list"><li class="social-item" title="simoes.sgabriel@gmail.com"><a href="mailto:simoes.sgabriel@gmail.com"><span class="social-icon icon-envelope" title="simoes.sgabriel@gmail.com"></span></a></li><li class="social-item" title="gabrielsimoes"><a href="https://github.com/gabrielsimoes"><span class="social-icon icon-social-github" title="gabrielsimoes"></span></a></li><li class="social-item" title="simoes.sgabriel"><a href="https://facebook.com/simoes.sgabriel"><span class="social-icon icon-social-facebook" title="simoes.sgabriel"></span></a></li><li class="social-item" title="simoessgabriel"><a href="https://linkedin.com/in/simoessgabriel"><span class="social-icon icon-social-linkedin" title="simoessgabriel"></span></a></li><li class="social-item" title="gabrielsimoes.github.io"><a href="https://gabrielsimoes.github.io"><span class="social-icon icon-globe" title="gabrielsimoes.github.io"></span></a></li><li class="social-item" title="Atom Feed"><a href="/atom.xml"><span class="social-icon icon-feed" title="Atom Feed"></span></a></li><li class="social-item" title="Indiana, US"><a href="#"><span class="social-icon icon-location-pin" title="Indiana, US"></span></a></li></ul></div></nav></header><main class="markdown-body"><article><div class="article-header"><h1 class="article-title">Object-relational impedance mismatch</h1><p class="article-subtitle">An attempt to get this right.</p><p class="article-date">June 26, 2018</p></div><p>This is the smart name we came up to call the difficulties that arise when we try to couple together a RDBMS (namely SQL), and an Object-Oriented design. We’ll first examine why this problem exists, and then take an attempt at solving it.</p> <h2 id="mismatches"><a class="anchor" href="#mismatches" aria-hidden="true">¶</a> Mismatches</h2> <ul> <li>When exposing a object in a object-relational mapping, we violate some properties of objects, namely <sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup>: <ul> <li><strong>Encapsulation</strong>: object properties which are expected in OO to be unexposed are necessarily exposed.</li> <li><strong>Accessbility</strong>: the relational has no notion of private/public access – everything is public.</li> <li><strong>Interface, class, inheritance and polymorphism</strong> are unknown concepts in the relational model, as well as <strong>views</strong><sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup> are something unknown to object orientation, which cannot be properly emulated with interfaces and methods. Still, the relational model has no notion of <strong>behaviour</strong>.</li> </ul> </li> <li>While OO <strong>structure</strong> is contructed based on links, and the relational model is made of global, unnested relation variables. Also, OO <strong>integrity</strong> is maintained through exceptions, while the relational model uses declarative contraints on the data.</li> <li>OO doesn’t have a small and well-defined set of <strong>maniplative operators</strong> like the relational model.</li> <li><strong>Transactions</strong> in the relational model can be very large and diverse, whereas in OO they are tipically made of individual assignments.</li> </ul> <h2 id="solving-the-problem-according-to-myself"><a class="anchor" href="#solving-the-problem-according-to-myself" aria-hidden="true">¶</a> Solving the problem according to myself</h2> <p>I’ll be honest. My opinion is that there is no way to actually solve this problem. In my view the two solutions are:</p> <ul> <li> <p><strong>Using objects</strong>: Ditch relational databases. Use key-value stores, document databases or other NoSQL databases. Don’t use a relational database where it doesn’t fit quite well.</p> </li> <li> <p><strong>Using SQL</strong>: Use relational models as they were designed. Relational models are designed to <em>answer questions about your data</em>, not to simply store objects. In this case, you’re better of using a Functional Programming language.</p> <p>We still might have some problems due to mutable data. One way were this problem wouldn’t exist is when we have an append-only architecture, but check below for other ideas.</p> </li> <li> <p><strong>Using both</strong>: If you try this, you’ll be unable to use both worlds efficiently. You’ll most probably not be using the greatest features of OO programming, or the greatest features of RDBMSs.</p> </li> </ul> <p>Stuart Halloway below describes a nice approach he uses in <a href="https://www.datomic.com/">Datomic</a>. In my view, his approach fits FP, but not OOP, even though he says otherwise.</p> <h2 id="solving-according-to-stuart-halloway-one-of-datomic-creators"><a class="anchor" href="#solving-according-to-stuart-halloway-one-of-datomic-creators" aria-hidden="true">¶</a> Solving according to Stuart Halloway (one of Datomic creators)</h2> <ul> <li> <p>A nice table from Stuart Halloway’s talk <sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup>:</p> <table> <thead> <tr> <th></th> <th>OO</th> <th>RDBMS</th> <th>We Want</th> </tr> </thead> <tbody> <tr> <td><strong>Processing</strong></td> <td>object at time</td> <td>set at a time</td> <td>both</td> </tr> <tr> <td><strong>Structure</strong></td> <td>dictionaries</td> <td>rectangles</td> <td>any</td> </tr> <tr> <td><strong>Access</strong></td> <td>navigation (pointers)</td> <td>query</td> <td>both</td> </tr> <tr> <td><strong>Location</strong></td> <td>over here</td> <td>over there</td> <td>anywhere</td> </tr> <tr> <td><strong>Programmable?</strong></td> <td>no</td> <td>no</td> <td>yes</td> </tr> <tr> <td><strong>Perception</strong></td> <td>coordinated</td> <td>coordinated</td> <td><strong>VALUES</strong></td> </tr> <tr> <td><strong>Action</strong></td> <td>assist use of tx system</td> <td>transaction</td> <td>any</td> </tr> </tbody> </table> </li> <li> <p><strong>The “over there” problem</strong>: many objects have to fetched at the same time because data could be changes out of the blue.</p> </li> <li> <p><strong>The “coordinated perception” problem</strong>: we have to use locks and stop everything to read data.</p> </li> <li> <p>We gotta simplify the two models in order to use them together.</p> </li> <li> <p>We can’t have everything from the OO and relational models.</p> </li> <li> <p><strong>VALUES</strong> are key to solving this problem. Data is made of values, not places. Data is immutable.</p> </li> <li> <p>The <a href="https://www.datomic.com/">Datomic</a> way:</p> <table> <thead> <tr> <th></th> <th>Solution</th> </tr> </thead> <tbody> <tr> <td><strong>Processing</strong></td> <td>any</td> </tr> <tr> <td><strong>Structure</strong></td> <td>any</td> </tr> <tr> <td><strong>Access</strong></td> <td>any</td> </tr> <tr> <td><strong>Location</strong></td> <td>anywhere</td> </tr> <tr> <td><strong>Programmable?</strong></td> <td>yes</td> </tr> <tr> <td><strong>Perception</strong></td> <td>values</td> </tr> <tr> <td><strong>Action</strong></td> <td>txes + tx fns</td> </tr> </tbody> </table> </li> <li> <p><strong>Bonuses</strong>:</p> <ul> <li>Time model (data from x time ago).</li> <li>Scale read and query horizontally.</li> <li>“What if” queries.</li> <li>Multi-source queries</li> </ul> </li> </ul> <hr class="footnotes-sep"> <section class="footnotes"> <ol class="footnotes-list"> <li id="fn1" class="footnote-item"><p><a href="https://en.wikipedia.org/wiki/Object-relational_impedance_mismatch">Wikipedia article on the Object-relational impedance mismatch</a>. <a href="#fnref1" class="footnote-backref">↩︎</a></p> </li> <li id="fn2" class="footnote-item"><p><a href="https://en.wikipedia.org/wiki/View_(SQL)">Wikipedia article on SQL Views</a>. <a href="#fnref2" class="footnote-backref">↩︎</a></p> </li> <li id="fn3" class="footnote-item"><p><a href="https://www.infoq.com/presentations/Impedance-Mismatch">The Impedance Mismatch is Our Fault - Stuart Halloway</a>. <a href="#fnref3" class="footnote-backref">↩︎</a></p> </li> </ol> </section> </article></main><footer>Site last updated: Sun, 21 Oct 2018 05:55:07 GMT.</footer><script src="https://unpkg.com/tippy.js@2.5.3/dist/tippy.all.min.js"></script><script src="/main.js"></script></body></html>