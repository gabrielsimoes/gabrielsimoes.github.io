<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="theme-color" content="#aa4b41"><title>Notes on &quot;Are We There Yet?&quot; by Rich Hickey // Gabriel Simões</title><meta name="Description" content="Blog Article Notes on &quot;Are We There Yet?&quot; by Rich Hickey"><link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"><link rel="icon" href="/favicon.ico" type="image/x-icon"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Mono|Fira+Sans" media="all"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/normalize.css@8.0.0/normalize.min.css" media="all"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0-beta/dist/katex.min.css" media="all"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlightjs@9.10.0/styles/gruvbox-dark.min.css" media="all"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/simple-line-icons@2.4.1/css/simple-line-icons.min.css" media="all"><link rel="stylesheet" href="/style.css" media="all"></head><body><header><div class="header-top"><img class="my-image" src="/me-bw.png" alt="A picture of me"><p class="my-name">Gabriel Simões</p><p class="my-occupation">Software Developer</p></div><nav><ul class="nav-menu"><li class="nav-item"><a class="nav-item-content" href="/">Home</a></li><li class="nav-item"><a class="nav-item-content" href="/blog.html">Blog</a></li><li class="nav-item"><a class="nav-item-content" href="/reading-watching-list.html">Reading/Watching List</a></li></ul><div class="cv-wrapper"><a class="cv-btn" href="/cv.pdf"><span class="icon-doc"> My CV</span></a></div><div class="social-list-wrapper"><ul class="social-list"><li class="social-item" title="simoes.sgabriel@gmail.com"><a href="mailto:simoes.sgabriel@gmail.com"><span class="social-icon icon-envelope" title="simoes.sgabriel@gmail.com"></span></a></li><li class="social-item" title="gabrielsimoes"><a href="https://github.com/gabrielsimoes"><span class="social-icon icon-social-github" title="gabrielsimoes"></span></a></li><li class="social-item" title="simoes.sgabriel"><a href="https://facebook.com/simoes.sgabriel"><span class="social-icon icon-social-facebook" title="simoes.sgabriel"></span></a></li><li class="social-item" title="simoessgabriel"><a href="https://linkedin.com/in/simoessgabriel"><span class="social-icon icon-social-linkedin" title="simoessgabriel"></span></a></li><li class="social-item" title="gabrielsimoes.github.io"><a href="https://gabrielsimoes.github.io"><span class="social-icon icon-globe" title="gabrielsimoes.github.io"></span></a></li><li class="social-item" title="Atom Feed"><a href="/atom.xml"><span class="social-icon icon-feed" title="Atom Feed"></span></a></li><li class="social-item" title="Indiana, US"><a href="#"><span class="social-icon icon-location-pin" title="Indiana, US"></span></a></li></ul></div></nav></header><main class="markdown-body"><article><div class="article-header"><h1 class="article-title">Notes on &quot;Are We There Yet?&quot; by Rich Hickey</h1><p class="article-subtitle">Amazing talk by Rich Hickey on fundamental Clojure and Functional Programming concurrency concepts. </p><p class="article-date">May 7, 2018</p></div><h2 id="introduction"><a class="anchor" href="#introduction" aria-hidden="true">¶</a> Introduction</h2> <ul> <li>All OO languages have fundamental things in common: <ul> <li>Single-dispatch, stateful OO.</li> <li>Classes, inheritance, fields, methods, GC</li> </ul> </li> <li>Differences are superficial: syntax, expressivity.</li> <li>C++: <ul> <li>Simple constructs, same syntax for heap/non-heap things.</li> <li>Complexity: knowing when/if to delete.</li> <li>No standard automatic memory management.</li> </ul> </li> <li>Java: <ul> <li>Simple: only references to dynamic memory + GC.</li> <li>Complexity: <em>knowing when you’ll see a consistent value</em>.</li> </ul> </li> <li><em>Pure functions are Worry-Free</em></li> <li><em>But</em> not all programs are pure functions.</li> </ul> <h2 id="things-we-are-doing-wrong"><a class="anchor" href="#things-we-are-doing-wrong" aria-hidden="true">¶</a> Things we are doing wrong</h2> <ul> <li>We created objects that can <em>change</em> in place.</li> <li>We left <em>time</em> out.</li> <li>Our languages have no notion of <em>values</em>.</li> <li>“No man can cross the same river twice.” - Heraclitus <ul> <li>Actual entities are atomic immutable values</li> <li>The future is a function of the past, it doesn’t change it</li> <li>We associate <em>identities</em> with a series of causally related values</li> <li>Time is atomic, epochal succession of process events</li> </ul> </li> <li>Terms <ul> <li><em>Value</em>: An <em>immutable</em> magnitude, quantity, number…</li> <li><em>Identity</em>: A succession of values whose causation is related.</li> <li><em>State</em>: <em>Snapshots</em>. Value of an identity at a <em>moment in time</em>.</li> <li><em>Time</em>: Relative before/after ordering of casual values.</li> </ul> </li> <li><em>Our programs try to “stop time” and know the state of everything to make decisions</em>. <ul> <li>Stadium analogy: “wait nobody move let me take a picture of the ball in mid-air”.</li> </ul> </li> <li>Truth is: <em>we are always perceiving the (unchanging!) past</em>.</li> <li>Our sensory systems have discretization and simultaneity detection.</li> <li>On the other hand, <em>action has to be sequential</em>. <ul> <li>No two things can affect the same thing at the same time.</li> <li>We have to sort of take turns.</li> </ul> </li> <li>Action and Perception are two different things.</li> </ul> <h2 id="epochal-time-model"><a class="anchor" href="#epochal-time-model" aria-hidden="true">¶</a> Epochal Time Model</h2> <p><img src="are-we-there-yet-epochal-time-model.png" alt="Epochal Time Model"></p> <ul> <li>A point in time is a value - it can’t be changed.</li> <li>Our program is still organized in identities (succession of states).</li> <li>We use pure functions to produce the feature.</li> </ul> <h2 id="implementation-ideas"><a class="anchor" href="#implementation-ideas" aria-hidden="true">¶</a> Implementation ideas</h2> <ul> <li> <p>We need constructs to represent values.</p> </li> <li> <p>We need constructs to coordinate the succession of values.</p> </li> <li> <p>We should consume memory to model time.</p> </li> <li> <p>GC cleans up longer-referenced ‘past’.</p> </li> <li> <p>Use <em>persistent data structures</em>.</p> <ul> <li>They are <em>immutable</em>.</li> <li>Use trees + path copying.</li> </ul> </li> <li> <p>Time constructs.</p> <ul> <li>Need to ensure atomic state succession.</li> <li>Need to provide point-in-time perception.</li> <li>Multiple timelines possible.</li> <li>Many implementation strategies: CAS, Agents, STM, maybe even locks.</li> </ul> </li> </ul> <h2 id="cas-compare-and-swap-as-a-time-construct"><a class="anchor" href="#cas-compare-and-swap-as-a-time-construct" aria-hidden="true">¶</a> CAS (Compare and Swap) as a Time Construct.</h2> <p><img src="are-we-there-yet-cas.png" alt="CAS"></p> <ul> <li>Uncoordinated 1:1.</li> <li>Replaces state based on comparisons.</li> </ul> <h2 id="agents-as-a-time-construct"><a class="anchor" href="#agents-as-a-time-construct" aria-hidden="true">¶</a> Agents as a Time Construct</h2> <p><img src="are-we-there-yet-agents.png" alt="Agents"></p> <ul> <li>Uncoordinated 1:1.</li> <li>Replaces state based on a queue through a thread pool.</li> </ul> <h2 id="stm-as-a-time-construct"><a class="anchor" href="#stm-as-a-time-construct" aria-hidden="true">¶</a> STM as a Time Construct</h2> <p><img src="are-we-there-yet-stm-1.png" alt="STM"></p> <ul> <li>Multiple timelines in the same app.</li> <li>A single transaction affects multiple timelines.</li> <li>ACI properties of ACID.</li> </ul> <p><img src="are-we-there-yet-stm-1.png" alt="STM Perception"></p> <ul> <li>Using a system that uses MVCC (Multi Version Concurrency Control), it is possible to percept snapshots.</li> <li>Keep history in order to satisfy readers.</li> <li>It allows readers to have their own notions of a timeline.</li> </ul> </article></main><footer>Site last updated: Mon, 05 Nov 2018 17:57:13 GMT.</footer><script src="https://unpkg.com/tippy.js@2.5.3/dist/tippy.all.min.js"></script><script src="/main.js"></script></body></html>